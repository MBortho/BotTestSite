<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>HANS HQ • Assistant</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="data:,">
  <style>
    :root {
      --page:#0a0f1d; --panel:#0b1020; --ink:#e5e7eb; --muted:#94a3b8;
      --ring:rgba(37,99,235,.4); --brand:#2563eb; --brand-2:#1e40af;
      --col-max:760px; --side-pad:16px; --header-h:56px; --input-h:80px;
      --bubble:#0f172a; --bubble-user:#1e293b; --bubble-brd:rgba(255,255,255,.08);
    }
    @media (prefers-color-scheme: light) {
      :root {
        --page:#f6f7f9; --panel:#ffffff; --ink:#0f172a; --muted:#6b7280;
        --bubble:#ffffff; --bubble-user:#f3f4f6; --bubble-brd:rgba(0,0,0,.08);
      }
    }

    *{box-sizing:border-box}
    html,body{height:100%;overflow-x:hidden}
    body{
      margin:0; background:var(--page); color:var(--ink);
      font:15px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      display:flex; flex-direction:column;
    }

    /* Header */
    .top {
      position:sticky; top:0; z-index:10;
      height:var(--header-h);
      display:flex; align-items:center; justify-content:center;
      backdrop-filter:saturate(180%) blur(6px);
      background:color-mix(in oklab, var(--page) 92%, #0000);
      border-bottom:1px solid color-mix(in oklab, var(--ink) 10%, #0000);
    }
    .brand { display:flex; align-items:center; gap:10px; font-weight:700; }
    .badge {
      width:26px; height:26px; border-radius:8px;
      background:linear-gradient(135deg,var(--brand),var(--brand-2));
      display:grid; place-items:center; color:#fff; font-weight:800; font-size:12px;
      box-shadow:0 4px 14px rgba(37,99,235,.35);
    }

    /* App layout */
    .app {
      flex:1;
      display:flex; flex-direction:column;
      align-items:center; justify-content:flex-start;
      width:100%;
    }

    /* Transcript area */
    .chat-area {
      flex:1;
      width:100%;
      max-width:var(--col-max);
      margin:0 auto;
      padding:20px var(--side-pad);
      overflow-y:auto;
      scrollbar-gutter: stable both-edges;
    }

    /* Bubbles */
    .webchat__bubble { max-width:90% !important; border-radius:12px; }
    #webchat, #webchat .webchat__stacked-layout, #webchat .webchat__basic-transcript { background:transparent; }
    #webchat .webchat__stacked-layout{ --webchat__avatar-size:0px; }
    #webchat .webchat__avatar{ display:none !important; }
    #webchat .webchat__basic-transcript__activity { padding:6px 0; }
    #webchat .webchat__basic-transcript { padding:0; overflow-x:hidden; }

    #webchat .webchat__bubble--from-bot .webchat__bubble {
      background:var(--bubble); border:1px solid var(--bubble-brd);
    }
    #webchat .webchat__bubble--from-user .webchat__bubble {
      background:var(--bubble-user); border:1px solid var(--bubble-brd);
    }

    /* Send box fixed bottom */
    .input-wrap {
      position:sticky; bottom:0;
      width:100%;
      background:linear-gradient(180deg, color-mix(in oklab, var(--page) 90%, transparent), var(--page));
      padding:12px var(--side-pad) 20px;
    }
    .input-inner {
      max-width:var(--col-max);
      margin:0 auto;
      background:var(--panel);
      border:1px solid color-mix(in oklab,var(--ink) 10%, #0000);
      border-radius:16px;
      box-shadow:0 10px 28px rgba(0,0,0,.08);
      overflow:hidden;
    }

    footer { color:var(--muted); text-align:center; padding:12px 0; font-size:13px; }

    /* Mobile */
    @media (max-width:600px){
      :root{ --col-max:100%; }
      .chat-area { padding:10px; }
    }
  </style>

  <script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script>
</head>
<body>
  <div class="top">
    <div class="brand"><div class="badge">HQ</div> HANS HQ</div>
  </div>

  <div class="app">
    <div class="chat-area">
      <div id="webchat" style="height:100%;"></div>
    </div>

    <div class="input-wrap">
      <div class="input-inner" id="input-box"></div>
    </div>
  </div>

  <footer>© <span id="year"></span> Ortho Molecular Products</footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    (async function () {
      const TOKEN_URL = 'https://orthohqbot-cgc2dgdac5b3daaa.centralus-01.azurewebsites.net/api/directline/token';
      const webchatEl = document.getElementById('webchat');

      try {
        const res = await fetch(TOKEN_URL, { cache: 'no-store' });
        if (!res.ok) throw new Error('Token fetch failed: ' + res.status);
        const { token } = await res.json();

        const brand  = getComputedStyle(document.documentElement).getPropertyValue('--brand').trim();
        const brand2 = getComputedStyle(document.documentElement).getPropertyValue('--brand-2').trim();

        const directLine = window.WebChat.createDirectLine({ token });

        const styleOptions = {
          primaryFont: 'system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif',
          fontSize: '15px',
          bubbleBorderRadius: 12,
          bubbleFromUserBorderRadius: 12,
          bubbleNubSize: 0,
          hideUploadButton: true,
          hideBotAvatar: true,
          hideUserAvatar: true,
          sendBoxHeight: 56,
          sendBoxPlaceholder: 'Send a message...',
          sendBoxButtonColor: brand,
          sendBoxButtonColorOnHover: brand2,
          backgroundColor: 'transparent',
          bubbleMaxWidth: 640,
        };

        window.WebChat.renderWebChat(
          {
            directLine,
            styleOptions,
            locale: 'en-US',
          },
          webchatEl
        );
      } catch (err) {
        console.error(err);
        webchatEl.innerHTML = '<div style="color:#b91c1c;padding:12px;">Failed to load chat. Refresh the page.</div>';
      }
    })();
  </script>
</body>
</html>
